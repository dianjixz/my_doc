# 程序的模块自动初始化

算是写模块程序偷懒吧,有的时候各个模块需要在主文件里运行时,总是需要一个一个进去初始化,看着非常的难受.我就在想有没有什么方法可以让这件事变成自动的呢,也就是程序帮我们自动去做一些模块的初始化工作,这样就解放了我们自己写程序了.

我尝试在宏函数中寻找相关的功能,但是发现宏并不提供链表添加的功能,没办法,继续在其他的方向寻找.

终于在linux内核中找出了相关的灵感.

linux内核有自动初始化的功能,其中主要的方法就是使用 **module_init**方法.经过相关研究,终于将这个方法使用的自己的工程里面了,所以现在把它分享出来.

这个方法需要链接脚本的支持.所以首先上场的是链接脚本.

~~~c
// 
SECTIONS
{
    . = ALIGN(16);
    __app_init_start__ = .;
    .app_init_sec : { *(.app_init_sec) }
    __app_init_end__ = .;
}
INSERT AFTER .rodata

~~~

该文件的
